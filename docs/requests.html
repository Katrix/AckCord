<!DOCTYPE html><html><head><title>AckCord: Making Requests</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Katrix" /><meta name="description" content="A Discord library built for flexibility and speed" /><meta name="og:image" content="/img/poster.png" /><meta name="image" property="og:image" content="/img/poster.png" /><meta name="og:title" content="AckCord: Making Requests" /><meta name="title" property="og:title" content="AckCord: Making Requests" /><meta name="og:site_name" content="AckCord" /><meta name="og:url" content="https://ackcord.katsstuff.net" /><meta name="og:type" content="website" /><meta name="og:description" content="A Discord library built for flexibility and speed" /><link rel="icon" type="image/png" href="/img/favicon.png" /><meta name="twitter:title" content="AckCord: Making Requests" /><meta name="twitter:image" content="/img/poster.png" /><meta name="twitter:description" content="A Discord library built for flexibility and speed" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/highlight/styles/vs.css" /><link rel="stylesheet" href="/css/pattern-style.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/" class="brand"><div class="brand-wrapper"><span>AckCord</span></div></a></li> <li><a href="/first_bot.html" class="">Your first bot</a></li> <li><a href="/docs/events.html" class="">Events</a></li> <li><a href="/docs/cachesnapshot.html" class="">CacheSnapshot</a></li> <li><a href="/docs/requests.html" class=" active ">Making Requests</a></li> <li><a href="/docs/slashcommands.html" class="">Slash commands</a></li> <li><a href="/docs/interactions.html" class="">Interactions</a></li> <li><a href="/docs/commands.html" class="">Old style commands</a></li> <li><a href="/docs/snowflakes.html" class="">Snowflake types</a></li> <li><a href="/docs/low-level/index.html" class="">The low level API</a> <ul class="sub-section"> <li><a href="/docs/low-level/first_bot.html" class="">Your first bot (Low level)</a></li> <li><a href="/docs/low-level/requests.html" class="">Making Requests (Low level)</a></li></ul></li> <li><a href="/docs/advanced/index.html" class="">Expanding AckCord</a> <ul class="sub-section"> <li><a href="/docs/advanced/cache.html" class="">The cache (Advanced)</a></li> <li><a href="/docs/advanced/custom_request.html" class="">Custom requests (Advanced)</a></li> <li><a href="/docs/advanced/sound.html" class="">Sending custom sound (Advanced)</a></li> <li><a href="/docs/advanced/actionbuilders_deep.html" class="">ActionBuilder deep dive (Advanced)</a></li> <li><a href="/docs/advanced/commands_deep.html" class="">Commands deep dive (Advanced)</a></li></ul></li> <li><a href="/modules.html" class="">The many modules of AckCord</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="search-nav hidden-xs hidden-sm"><div id="search-dropdown"><label><i class="fa fa-search"></i>Search</label><input id="search-bar" type="text" placeholder="Enter keywords here..." onclick="displayToggleSearch(event)" /><ul id="search-dropdown-content" class="dropdown dropdown-content"></ul></div></li><li id="gh-eyes-item" class="hidden-xs to-uppercase"><a href="https://github.com/Katrix/AckCord" target="_blank" rel="noopener noreferrer"><i class="fa fa-eye"></i><span>Watchers<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs to-uppercase"><a href="https://github.com/Katrix/AckCord" target="_blank" rel="noopener noreferrer"><i class="fa fa-star-o"></i><span>Stars<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="Katrix" data-github-repo="AckCord"><div class="content-wrapper"><section><h1 id="making-requests">Making Requests</h1>
<p>Requests are how most bot actions are done. Stuff like sending messages, 
creating channels and managing users. AckCord represents every request as an
object you construct. There are many ways to send an request, but the most 
common are through the end action on controllers, and using <code class="highlighter-rouge">RequestsHelper</code>. 
To create a request object, you can either just construct it normally, or use 
the syntax package.</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">ackcord.requests._</span>
<span class="k">import</span> <span class="nn">ackcord.syntax._</span>

<span class="nv">client</span><span class="o">.</span><span class="py">onEventSideEffects</span> <span class="o">{</span> <span class="k">implicit</span> <span class="n">c</span> <span class="k">=&gt;</span> 
  <span class="o">{</span>
    <span class="k">case</span> <span class="nv">APIMessage</span><span class="o">.</span><span class="py">ChannelCreate</span><span class="o">(</span><span class="k">_</span><span class="o">,</span> <span class="n">channel</span><span class="k">:</span> <span class="kt">TextGuildChannel</span><span class="o">,</span> <span class="k">_</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
      <span class="c1">//There is also CreateMessage.mkContent for this specific pattern</span>
      <span class="k">val</span> <span class="nv">constructManually</span> <span class="k">=</span> <span class="nc">CreateMessage</span><span class="o">(</span><span class="nv">channel</span><span class="o">.</span><span class="py">id</span><span class="o">,</span> <span class="nc">CreateMessageData</span><span class="o">(</span><span class="n">content</span> <span class="k">=</span> <span class="s">"Hello World"</span><span class="o">))</span>
      <span class="k">val</span> <span class="nv">usingSyntax</span> <span class="k">=</span> <span class="nv">channel</span><span class="o">.</span><span class="py">sendMessage</span><span class="o">(</span><span class="n">content</span> <span class="k">=</span> <span class="s">"Hello World"</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Next you need to send the request. For this example we will use <code class="highlighter-rouge">RequestsHelper</code>. 
This object can be found on the client. That also means it’s time to move away
from <code class="highlighter-rouge">onEventSideEffects</code>. Even though sending requests can never 
return option, the <code class="highlighter-rouge">run</code> command will return an <code class="highlighter-rouge">OptFuture[A]</code>. 
<code class="highlighter-rouge">OptFuture[A]</code> is a wrapper around <code class="highlighter-rouge">Future[Option[A]]</code>. This is done
due to the many cache lookup methods that return <code class="highlighter-rouge">Option</code>s.
When your event handler returns <code class="highlighter-rouge">OptFuture[Unit]</code>, you’re recommended 
to use <code class="highlighter-rouge">DiscordClient#onEventAsync</code> and <code class="highlighter-rouge">ActionBuilder#asyncOpt</code> instead.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">client</span><span class="o">.</span><span class="py">onEventAsync</span> <span class="o">{</span> <span class="k">implicit</span> <span class="n">c</span> <span class="k">=&gt;</span> 
  <span class="o">{</span>
    <span class="k">case</span> <span class="nv">APIMessage</span><span class="o">.</span><span class="py">ChannelCreate</span><span class="o">(</span><span class="k">_</span><span class="o">,</span> <span class="n">channel</span><span class="k">:</span> <span class="kt">TextGuildChannel</span><span class="o">,</span> <span class="k">_</span><span class="o">,</span> <span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
      <span class="nv">client</span><span class="o">.</span><span class="py">requestsHelper</span><span class="o">.</span><span class="py">run</span><span class="o">(</span><span class="nv">channel</span><span class="o">.</span><span class="py">sendMessage</span><span class="o">(</span><span class="n">content</span> <span class="k">=</span> <span class="s">"Hello World"</span><span class="o">)).</span><span class="py">map</span><span class="o">(</span><span class="k">_</span> <span class="k">=&gt;</span> <span class="o">())</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">RequestsHelper</code> object also contains lots of small helpers to deal with 
<code class="highlighter-rouge">OptFuture[A]</code> and requests.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">client</span><span class="o">.</span><span class="py">onEventAsync</span> <span class="o">{</span> <span class="k">implicit</span> <span class="n">c</span> <span class="k">=&gt;</span> 
  <span class="o">{</span>
    <span class="k">case</span> <span class="n">msg</span><span class="k">:</span> <span class="kt">APIMessage.ChannelCreate</span> <span class="o">=&gt;</span>
      <span class="k">import</span> <span class="nn">client.requestsHelper._</span>
      <span class="k">for</span> <span class="o">{</span>
        <span class="c1">//optionPure lifts an Option into the dsl</span>
        <span class="n">guildChannel</span> <span class="k">&lt;-</span> <span class="nf">optionPure</span><span class="o">(</span><span class="nv">msg</span><span class="o">.</span><span class="py">channel</span><span class="o">.</span><span class="py">asGuildChannel</span><span class="o">)</span>
        <span class="n">guild</span>        <span class="k">&lt;-</span> <span class="nf">optionPure</span><span class="o">(</span><span class="nv">guildChannel</span><span class="o">.</span><span class="py">guild</span><span class="o">)</span>
        <span class="c1">//runOption runs an Option[Request].</span>
        <span class="n">msg</span>          <span class="k">&lt;-</span> <span class="nf">runOption</span><span class="o">(</span><span class="nv">guild</span><span class="o">.</span><span class="py">textChannels</span><span class="o">.</span><span class="py">headOption</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">sendMessage</span><span class="o">(</span><span class="s">"FIRST"</span><span class="o">)))</span>
        <span class="c1">//Running a request without using the extra syntax</span>
        <span class="k">_</span>            <span class="k">&lt;-</span> <span class="nf">run</span><span class="o">(</span><span class="nv">CreateMessage</span><span class="o">.</span><span class="py">mkContent</span><span class="o">(</span><span class="nv">msg</span><span class="o">.</span><span class="py">channelId</span><span class="o">,</span> <span class="s">"Another message"</span><span class="o">))</span>
      <span class="o">}</span> <span class="nf">yield</span> <span class="o">()</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/highlight/highlight.pack.js"></script><script src="/lunr/lunr.js"></script><script>
// For all code blocks, copy the language from the containing div
// to the inner code tag (where hljs expects it to be)
const langPrefix = 'language-';
document.querySelectorAll(`div[class^='${langPrefix}']`).forEach(function(div) {
  div.classList.forEach(function(cssClass) {
    if (cssClass.startsWith(langPrefix)) {
      const lang = cssClass.substring(langPrefix.length);
      div.querySelectorAll('pre code').forEach(function(code) {
        code.classList.add(lang);
      });
    }
  });
});

hljs.configure({languages:['scala','java','bash']});
hljs.initHighlightingOnLoad();
      </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script src="/js/search.js"></script><script src="/js/main.js"></script></body></html>