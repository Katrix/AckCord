<!DOCTYPE html><html><head><title>AckCord: Custom requests (Advanced)</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Katrix" /><meta name="description" content="A Discord library built for flexibility and speed" /><meta name="og:image" content="/img/poster.png" /><meta name="image" property="og:image" content="/img/poster.png" /><meta name="og:title" content="AckCord: Custom requests (Advanced)" /><meta name="title" property="og:title" content="AckCord: Custom requests (Advanced)" /><meta name="og:site_name" content="AckCord" /><meta name="og:url" content="https://ackcord.katsstuff.net" /><meta name="og:type" content="website" /><meta name="og:description" content="A Discord library built for flexibility and speed" /><link rel="icon" type="image/png" href="/img/favicon.png" /><meta name="twitter:title" content="AckCord: Custom requests (Advanced)" /><meta name="twitter:image" content="/img/poster.png" /><meta name="twitter:description" content="A Discord library built for flexibility and speed" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/highlight/styles/vs.css" /><link rel="stylesheet" href="/css/pattern-style.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/" class="brand"><div class="brand-wrapper"><span>AckCord</span></div></a></li> <li><a href="/first_bot.html" class="">Your first bot</a></li> <li><a href="/docs/events.html" class="">Events</a></li> <li><a href="/docs/cachesnapshot.html" class="">CacheSnapshot</a></li> <li><a href="/docs/requests.html" class="">Making Requests</a></li> <li><a href="/docs/slashcommands.html" class="">Slash commands</a></li> <li><a href="/docs/interactions.html" class="">Interactions</a></li> <li><a href="/docs/commands.html" class="">Old style commands</a></li> <li><a href="/docs/snowflakes.html" class="">Snowflake types</a></li> <li><a href="/docs/low-level/index.html" class="">The low level API</a> <ul class="sub-section"> <li><a href="/docs/low-level/first_bot.html" class="">Your first bot (Low level)</a></li> <li><a href="/docs/low-level/requests.html" class="">Making Requests (Low level)</a></li></ul></li> <li><a href="/docs/advanced/index.html" class="">Expanding AckCord</a> <ul class="sub-section"> <li><a href="/docs/advanced/cache.html" class="">The cache (Advanced)</a></li> <li><a href="/docs/advanced/custom_request.html" class=" active ">Custom requests (Advanced)</a></li> <li><a href="/docs/advanced/sound.html" class="">Sending custom sound (Advanced)</a></li> <li><a href="/docs/advanced/actionbuilders_deep.html" class="">ActionBuilder deep dive (Advanced)</a></li> <li><a href="/docs/advanced/commands_deep.html" class="">Commands deep dive (Advanced)</a></li></ul></li> <li><a href="/modules.html" class="">The many modules of AckCord</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="search-nav hidden-xs hidden-sm"><div id="search-dropdown"><label><i class="fa fa-search"></i>Search</label><input id="search-bar" type="text" placeholder="Enter keywords here..." onclick="displayToggleSearch(event)" /><ul id="search-dropdown-content" class="dropdown dropdown-content"></ul></div></li><li id="gh-eyes-item" class="hidden-xs to-uppercase"><a href="https://github.com/Katrix/AckCord" target="_blank" rel="noopener noreferrer"><i class="fa fa-eye"></i><span>Watchers<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs to-uppercase"><a href="https://github.com/Katrix/AckCord" target="_blank" rel="noopener noreferrer"><i class="fa fa-star-o"></i><span>Stars<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="Katrix" data-github-repo="AckCord"><div class="content-wrapper"><section><h1 id="custom-requests">Custom requests</h1>
<p>Sometimes Discord releases a new endpoint that you want to use, but AckCord 
hasn’t added it yet, or maybe you want to use an internal endpoint. How can you 
use AckCord’s code to perform the request?</p>

<p>Recall that AckCord’s requests are represented as objects. To create a new 
request, you need a new subclass of this request type. While it’s possible to 
extend <code class="highlighter-rouge">Request</code> directly, in most cases you probably want to 
extend <code class="highlighter-rouge">RESTRequest</code> or one of it’s children.</p>

<p>There are many options here, so let’s go over them all:</p>
<ul>
  <li><code class="highlighter-rouge">NoParamsRequest</code>: Use this if it doesn’t take a body.</li>
  <li><code class="highlighter-rouge">ReasonRequest</code>: Use this if the action you’re perfoming can leave an audit log
and you want a special message in that audit log entry.</li>
  <li><code class="highlighter-rouge">NoNiceResponseRequest</code>: Most requests have both a raw representation and a nicer
 representation. Not all though. Use this when there is no such distinction.</li>
  <li><code class="highlighter-rouge">NoParamsReasonRequest</code>: Combines <code class="highlighter-rouge">NoParamsRequest</code> and <code class="highlighter-rouge">ReasonRequest</code>.</li>
  <li><code class="highlighter-rouge">NoNiceResponseReasonRequest</code>: Combines <code class="highlighter-rouge">NoNiceResponseRequest</code> and <code class="highlighter-rouge">ReasonRequest</code>.</li>
  <li><code class="highlighter-rouge">NoParamsNiceResponseRequest</code>: Combines <code class="highlighter-rouge">NoParamsRequest</code> and <code class="highlighter-rouge">NoNiceResponseRequest</code>.</li>
  <li><code class="highlighter-rouge">NoParamsNiceResponseReasonRequest</code>: Combines <code class="highlighter-rouge">NoParamsNiceResponseReques</code> and <code class="highlighter-rouge">ReasonRequest</code>.</li>
  <li><code class="highlighter-rouge">NoResponseRequest</code>: Used for requests that return 204.</li>
  <li><code class="highlighter-rouge">NoResponseReasonRequest</code>: Combines <code class="highlighter-rouge">NoResponseRequest</code> and <code class="highlighter-rouge">ReasonRequest</code>.</li>
  <li><code class="highlighter-rouge">NoParamsResponseRequest</code>: Combines <code class="highlighter-rouge">NoResponseRequest</code> and <code class="highlighter-rouge">NoParamsRequest</code>.</li>
  <li><code class="highlighter-rouge">NoParamsResponseReasonRequest</code>: Combines <code class="highlighter-rouge">NoParamsResponseRequest</code> and <code class="highlighter-rouge">ReasonRequest</code>.</li>
  <li><code class="highlighter-rouge">RESTRequest</code>: If nothing else works</li>
</ul>

<p>You don’t have to choose what first best for your case though. Most of these just 
help reduce boilerplate.</p>

<p>When defining the request itself, you want it to take the needed body, an 
encoder for the body, a decoder for the result, and the for the request to go to.</p>

<p>Everything you need to make the route can be found in <code class="highlighter-rouge">ackcord.requests.Routes</code>.</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">ackcord.requests.Routes._</span>
<span class="k">import</span> <span class="nn">akka.http.scaladsl.model.HttpMethods._</span>

<span class="c1">//In most cases you either want to start at base</span>
<span class="k">val</span> <span class="nv">foo</span> <span class="k">=</span> <span class="n">base</span> <span class="o">/</span> <span class="s">"foo"</span>
<span class="c1">// foo: Route = Route(</span>
<span class="c1">//   uriWithMajor = "https://discord.com/api/v9/foo",</span>
<span class="c1">//   uriWithoutMajor = "https://discord.com/api/v9/foo",</span>
<span class="c1">//   applied = Uri(</span>
<span class="c1">//     scheme = "https",</span>
<span class="c1">//     authority = Authority(</span>
<span class="c1">//       host = NamedHost(address = "discord.com"),</span>
<span class="c1">//       port = 0,</span>
<span class="c1">//       userinfo = ""</span>
<span class="c1">//     ),</span>
<span class="c1">//     path = Slash(</span>
<span class="c1">//       tail = Segment(</span>
<span class="c1">//         head = "api",</span>
<span class="c1">//         tail = Slash(</span>
<span class="c1">//           tail = Segment(</span>
<span class="c1">//             head = "v9",</span>
<span class="c1">//             tail = Slash(tail = Segment(head = "foo", tail = ))</span>
<span class="c1">//           )</span>
<span class="c1">//         )</span>
<span class="c1">//       )</span>
<span class="c1">//     ),</span>
<span class="c1">//     rawQueryString = None,</span>
<span class="c1">//     fragment = None</span>
<span class="c1">//   )</span>
<span class="c1">// )</span>

<span class="c1">//Or one of the already defined routes</span>
<span class="k">val</span> <span class="nv">bar</span> <span class="k">=</span> <span class="n">guild</span> <span class="o">/</span> <span class="s">"bar"</span>
<span class="c1">// bar: RouteFunction[ackcord.data.package.GuildId] = RouteFunction(</span>
<span class="c1">//   route = scala.Function1$$Lambda$10210/0x00000008028ffbe8@4e5cc1d</span>
<span class="c1">// )</span>

<span class="c1">//If you have some parameter, you you the coresponding parameter type</span>
<span class="k">val</span> <span class="nv">barUser</span> <span class="k">=</span> <span class="n">bar</span> <span class="o">/</span> <span class="n">userId</span>
<span class="c1">// barUser: RouteFunction[(ackcord.data.package.GuildId, ackcord.data.package.UserId)] = RouteFunction(</span>
<span class="c1">//   route = scala.Function2$$Lambda$9423/0x0000000802766380@5c48f5ba</span>
<span class="c1">// )</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Bin</span><span class="o">(</span><span class="n">binName</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>

<span class="c1">//If there is no parameter type for what you want, you can create it</span>
<span class="c1">//In most cases you want minor parameters</span>
<span class="k">val</span> <span class="nv">bin</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MinorParameter</span><span class="o">[</span><span class="kt">Bin</span><span class="o">](</span><span class="s">"bin"</span><span class="o">,</span> <span class="nv">_</span><span class="o">.</span><span class="py">binName</span><span class="o">)</span>
<span class="c1">// bin: MinorParameter[Bin] = ackcord.requests.Routes$MinorParameter@1a783913</span>

<span class="c1">//Use it like any other parameter</span>
<span class="k">val</span> <span class="nv">guildBin</span> <span class="k">=</span> <span class="n">guild</span> <span class="o">/</span> <span class="n">bin</span>
<span class="c1">// guildBin: RouteFunction[(ackcord.data.package.GuildId, Bin)] = RouteFunction(</span>
<span class="c1">//   route = scala.Function2$$Lambda$9423/0x0000000802766380@461c6156</span>
<span class="c1">// )</span>

<span class="c1">//Once you've defined the path of the requst, call toRequest with the method to </span>
<span class="c1">//get a useable request route</span>
<span class="k">val</span> <span class="nv">getGuildBin</span> <span class="k">=</span> <span class="nv">guildBin</span><span class="o">.</span><span class="py">toRequest</span><span class="o">(</span><span class="nc">GET</span><span class="o">)</span>
<span class="c1">// getGuildBin: (ackcord.data.package.GuildId, Bin) =&gt; ackcord.requests.RequestRoute = shapeless.ops.FnFromProductInstances$$Lambda$10233/0x0000000802938b60@1d776827</span>

<span class="c1">// Queries are also parameters</span>
<span class="k">val</span> <span class="nv">height</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">QueryParameter</span><span class="o">[</span><span class="kt">Int</span><span class="o">](</span><span class="s">"height"</span><span class="o">,</span> <span class="nv">_</span><span class="o">.</span><span class="py">toString</span><span class="o">)</span>
<span class="c1">// height: QueryParameter[Int] = ackcord.requests.Routes$QueryParameter@7036fd2c</span>

<span class="c1">//Use +? to use a query parameter</span>
<span class="k">val</span> <span class="nv">binWithHeight</span> <span class="k">=</span> <span class="n">guildBin</span> <span class="o">+?</span> <span class="n">height</span>
<span class="c1">// binWithHeight: QueryRouteFunction[((ackcord.data.package.GuildId, Bin), Option[Int])] = QueryRouteFunction(</span>
<span class="c1">//   route = scala.Function2$$Lambda$9423/0x0000000802766380@bc6eeec</span>
<span class="c1">// )</span>

<span class="c1">//You can also define a query parameter inline with query</span>
<span class="k">val</span> <span class="nv">binWithWidth</span> <span class="k">=</span> <span class="n">guildBin</span> <span class="o">+?</span> <span class="n">query</span><span class="o">[</span><span class="kt">Int</span><span class="o">](</span><span class="s">"width"</span><span class="o">,</span> <span class="nv">_</span><span class="o">.</span><span class="py">toString</span><span class="o">)</span>
<span class="c1">// binWithWidth: QueryRouteFunction[((ackcord.data.package.GuildId, Bin), Option[Int])] = QueryRouteFunction(</span>
<span class="c1">//   route = scala.Function2$$Lambda$9423/0x0000000802766380@7025afc3</span>
<span class="c1">// )</span>
</code></pre></div></div>

<p>Look at the existing requests and routes in AckCord to get a better idea of 
how to do it yourself.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/highlight/highlight.pack.js"></script><script src="/lunr/lunr.js"></script><script>
// For all code blocks, copy the language from the containing div
// to the inner code tag (where hljs expects it to be)
const langPrefix = 'language-';
document.querySelectorAll(`div[class^='${langPrefix}']`).forEach(function(div) {
  div.classList.forEach(function(cssClass) {
    if (cssClass.startsWith(langPrefix)) {
      const lang = cssClass.substring(langPrefix.length);
      div.querySelectorAll('pre code').forEach(function(code) {
        code.classList.add(lang);
      });
    }
  });
});

hljs.configure({languages:['scala','java','bash']});
hljs.initHighlightingOnLoad();
      </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script src="/js/search.js"></script><script src="/js/main.js"></script></body></html>